version: "3"

services:
  controller:
    build: src/Controller
    command: java Controller.java

  1-router:
    build: src/Router/
    command: java Router.java 1-router 2-router
    links:
      - "1-forwarding-service:fs"

  1-forwarding-service:
    build: src/ForwardingService
    command: java ForwardingService.java 1-router

  2-router:
    build: src/Router/
    command: java Router.java 2-router 1-router
    links:
      - "2-forwarding-service:fs"

  2-forwarding-service:
    build: src/ForwardingService
    command: java ForwardingService.java 2-router

  tcpdump:
    image: kaazing/tcpdump
    volumes:
      - ./tcpdump:/tcpdump
    network_mode: host
