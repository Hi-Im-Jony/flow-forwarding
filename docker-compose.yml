version: "3"

services:
  controller:
    build: src/Controller
    command: java Controller.java

  1-router:
    build: src/Router/
    command: java Router.java trinity scss Jonathan
    links:
      - "1-forwarding-service:fs"
    depends_on:
      - controller

  1-forwarding-service:
    build: src/ForwardingService
    command: java ForwardingService.java trinity

  2-router:
    build: src/Router/
    command: java Router.java scss trinity
    links:
      - "2-forwarding-service:fs"
    depends_on:
      - controller

  2-forwarding-service:
    build: src/ForwardingService
    command: java ForwardingService.java scss

  3-router:
    build: src/Router/
    command: java Router.java Jonathan trinity
    links:
      - "3-forwarding-service:fs"
    depends_on:
      - controller

  3-forwarding-service:
    build: src/ForwardingService
    command: java ForwardingService.java Jonathan

  tcpdump:
    image: kaazing/tcpdump
    volumes:
      - ./tcpdump:/tcpdump
    network_mode: host
